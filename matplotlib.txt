#!/bin/bash

# Path to your annotation file
annotation_file="annotation.gff"

# Loop through each variant in your sorted variant file
while read line; do
    # Extract variant position and adjust for 1-based index
    variant=$(echo $line | awk '{print $1}')
    position=$(echo $variant | awk -F"[_.]" '{print $3}')
    chromosome=$(echo $variant | awk -F"[_.]" '{print $2}')
    
    # Find the corresponding gene in the annotation file
    gene=$(awk -v chr=$chromosome -v pos=$position '$1 == chr && $4 <= pos && $5 >= pos && $3 == "gene" {print $9}' $annotation_file | awk -F";" '{print $1}' | awk -F"=" '{print $2}')
    
    # Print variant and associated gene
    echo "$variant $gene"
done < sorted_variant_file.txt
